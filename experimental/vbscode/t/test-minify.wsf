<?xml version="1.0" ?>
<package>
<job>
<runtime>
<description><![CDATA[
Test suite for VBSCode
]]></description>
<example><![CDATA[
Examples:

- Read from the file INPUTFILE and print to the standard output
  cscript //nologo test-minify.wsf minifier < INPUTFILE

- Read from the file INPUTFILE and redirect output to another one
  cscript //nologo test-minify.wsf minifier < INPUTFILE > OUTPUTFILE

]]></example>
<unnamed
	name="minifier"
	helpstring="The path to the VBSCode file (original or minified)"
	required="true"
	/>
</runtime>
<!--<script language="vbscript" src="../lib/vbscode.vbs"></script>-->
<script language="vbscript"><![CDATA[

Option Explicit

Sub import(file)
	On Error GoTo 0

	Dim fso, stream, text

	Set fso = CreateObject("Scripting.FileSystemObject")
	Set stream = fso.OpenTextFile(file, 1, False)
	text = stream.ReadAll
	stream.Close

	ExecuteGlobal text

	On Error Resume Next
End Sub

]]></script>
<script language="vbscript"><![CDATA[

Option Explicit

If WScript.Arguments.Count = 0 Then
	WScript.Arguments.ShowUsage
	WScript.Quit
End If

import WScript.Arguments(0)

Dim text

text = WScript.StdIn.ReadAll()
text = new VBSCode.minify(text)

WScript.StdOut.Write(text)

]]></script>
</job>
</package>
