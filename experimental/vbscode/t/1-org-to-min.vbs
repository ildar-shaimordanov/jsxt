Option Explicit:Class VBSCode:Private re_comment_or_continue:Private re_outer_spaces:Private re_space_punct:Private re_punct_space:Private re_inner_colons:Private re_word_space_word:Private re_outer_colons:Private Sub Class_Initialize:Set re_comment_or_continue=New RegExp:re_comment_or_continue.Global=True:re_comment_or_continue.IgnoreCase=True:re_comment_or_continue.Pattern="""[^""]*"""&"|[\s:]*('|\brem\b).*"&"|(\w\s|\W)\s*_$":Set re_outer_spaces=New RegExp:re_outer_spaces.Global=True:re_outer_spaces.Pattern="^\s+|\s+$":Set re_space_punct=New RegExp:re_space_punct.Global=True:re_space_punct.Pattern="\s+([\[\]()<>&.,:=*/%+-])":Set re_punct_space=New RegExp:re_punct_space.Global=True:re_punct_space.Pattern="([\[\]()<>&.,:=*/%+-])\s+":Set re_inner_colons=New RegExp:re_inner_colons.Global=True:re_inner_colons.Pattern=":+":Set re_word_space_word=New RegExp:re_word_space_word.Global=True:re_word_space_word.Pattern="(\w)\s+(\w)":Set re_outer_colons=New RegExp:re_outer_colons.Global=True:re_outer_colons.Pattern="^:+|:+$":End Sub:Public Function minify(text):Dim lines,i,line:text=Replace(text,Chr(13),Chr(10)):lines=Split(text,Chr(10)):For i=0 To UBound(lines):line=lines(i):line=remove_comment_and_continuation(line):lines(i)=line:Next:text=Join(lines,""):text=reduce_space_and_punct(text):text=remove_outer_colons(text):minify=text:End Function:Private Function remove_comment_and_continuation(text):Dim eol,matches,match:eol=":":Set matches=re_comment_or_continue.Execute(text):For Each match in matches:If match.SubMatches(0)<>""Then:text=Left(text,match.FirstIndex):Exit For:End If:If match.SubMatches(1)<>""Then:eol=" ":text=Left(text,match.FirstIndex)&match.SubMatches(1):Exit For:End If:Next:If text<>""Then:text=text&eol:End If:remove_comment_and_continuation=text:End Function:Private Function reduce_space_and_punct(text):Dim chunks,i,chunk:chunks=Split(text,""""):For i=0 To UBound(chunks)Step 2:chunk=chunks(i):chunk=re_outer_spaces.Replace(chunk,""):chunk=re_space_punct.Replace(chunk,"$1"):chunk=re_punct_space.Replace(chunk,"$1"):chunk=re_inner_colons.Replace(chunk,":"):chunk=re_word_space_word.Replace(chunk,"$1 $2"):chunks(i)=chunk:Next:reduce_space_and_punct=Join(chunks,""""):End Function:Private Function remove_outer_colons(text):remove_outer_colons=re_outer_colons.Replace(text,""):End Function:End Class